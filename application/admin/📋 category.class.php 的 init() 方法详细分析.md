æˆ‘æ¥å¸®ä½ è¯¦ç»†åˆ†æè¿™ä¸ª `init()` æ–¹æ³•ã€‚é¦–å…ˆè®©æˆ‘è¯»å–å®Œæ•´çš„æ–‡ä»¶å†…å®¹å’Œç›¸å…³çš„é¡¹ç›®æ–‡ä»¶ï¼Œä»¥ä¾¿æ›´å¥½åœ°ç†è§£æ•´ä¸ªä¸Šä¸‹æ–‡ã€‚

[5 tools called]

ç°åœ¨è®©æˆ‘ç»§ç»­æŸ¥æ‰¾ä¸€äº›å…³é”®çš„è¾…åŠ©å‡½æ•°å’Œæ¨¡æ¿æ–‡ä»¶ï¼š

[3 tools called]

è®©æˆ‘æŸ¥çœ‹æ¨¡æ¿æ–‡ä»¶ä»¥å®Œæ•´ç†è§£æ•´ä¸ªæµç¨‹ï¼š

[2 tools called]

ç°åœ¨æˆ‘å·²ç»æ”¶é›†åˆ°è¶³å¤Ÿçš„ä¿¡æ¯ï¼Œè®©æˆ‘ä¸ºä½ è¯¦ç»†åˆ†æè¿™ä¸ª `init()` æ–¹æ³•çš„æ¯è¡Œä»£ç åŠå…¶åŠŸèƒ½ã€‚

## ğŸ“‹ category.class.php çš„ init() æ–¹æ³•è¯¦ç»†åˆ†æ

è¿™æ˜¯ä¸€ä¸ª**åå°æ ç›®ç®¡ç†åˆ—è¡¨é¡µé¢**çš„æ ¸å¿ƒæ–¹æ³•ï¼Œç”¨äºç”Ÿæˆå¸¦æœ‰å±•å¼€/æ”¶èµ·åŠŸèƒ½çš„æ ‘å½¢æ ç›®ç»“æ„åˆ—è¡¨ã€‚

---

### ğŸ¯ **æ•´ä½“åŠŸèƒ½æ¦‚è¿°**

è¯¥æ–¹æ³•å®ç°äº†ä¸€ä¸ªåŠŸèƒ½å®Œæ•´çš„æ ç›®ç®¡ç†ç•Œé¢ï¼Œå…·å¤‡ï¼š
- æ ‘å½¢ç»“æ„å±•ç¤ºæ ç›®å±‚çº§å…³ç³»
- è®°ä½ç”¨æˆ·çš„å±•å¼€/æ”¶èµ·çŠ¶æ€ï¼ˆé€šè¿‡Cookieï¼‰
- æ”¯æŒç¼–è¾‘ã€åˆ é™¤ã€æ·»åŠ å­æ ç›®ç­‰æ“ä½œ
- æ˜¾ç¤ºæ ç›®ç±»å‹ã€æ¨¡å‹ã€çŠ¶æ€ç­‰ä¿¡æ¯

---

### ğŸ“ **é€è¡Œä»£ç åˆ†æ**

#### **ç¬¬ 15 è¡Œï¼šæ–¹æ³•å®šä¹‰**
```php
public function init(){
```
- è¿™æ˜¯æ§åˆ¶å™¨çš„**é»˜è®¤å…¥å£æ–¹æ³•**ï¼ˆç±»ä¼¼äº index æ–¹æ³•ï¼‰
- å½“è®¿é—® `/lry_admin_center/category` æ—¶ï¼Œä¼šè‡ªåŠ¨è°ƒç”¨æ­¤æ–¹æ³•

---

#### **ç¬¬ 16-20 è¡Œï¼šè·å–æ¨¡å‹ä¿¡æ¯å¹¶å»ºç«‹æ˜ å°„**
```php
$modelinfo = get_site_modelinfo();
$modelarr = array();
foreach($modelinfo as $val){
    $modelarr[$val['modelid']] = $val['name'];
}
```

**ä½œç”¨**ï¼š
- `get_site_modelinfo()`: ä»æ•°æ®åº“è·å–å½“å‰ç«™ç‚¹çš„æ‰€æœ‰æ¨¡å‹ï¼ˆå¦‚æ–‡ç« æ¨¡å‹ã€äº§å“æ¨¡å‹ç­‰ï¼‰
- å»ºç«‹ `æ¨¡å‹ID => æ¨¡å‹åç§°` çš„æ˜ å°„å…³ç³»
- **ç”¨é€”**ï¼šåé¢åœ¨æ˜¾ç¤ºæ ç›®æ—¶ï¼Œéœ€è¦æ˜¾ç¤ºæ ç›®æ‰€å±çš„æ¨¡å‹åç§°

**ç¤ºä¾‹æ•°æ®**ï¼š
```php
// $modelinfo åŸå§‹æ•°æ®
[
    ['modelid' => 1, 'name' => 'æ–‡ç« æ¨¡å‹', 'tablename' => 'article'],
    ['modelid' => 2, 'name' => 'äº§å“æ¨¡å‹', 'tablename' => 'product']
]

// è½¬æ¢åçš„ $modelarr
[
    1 => 'æ–‡ç« æ¨¡å‹',
    2 => 'äº§å“æ¨¡å‹'
]
```

---

#### **ç¬¬ 22 è¡Œï¼šè¯»å–æ ç›®å±•å¼€/æ”¶èµ·çŠ¶æ€**
```php
$category_show_status = isset($_COOKIE['category_show_status_'.self::$siteid]) 
    ? json_decode($_COOKIE['category_show_status_'.self::$siteid], true) 
    : array();
```

**ä½œç”¨**ï¼š
- ä» Cookie ä¸­è¯»å–ç”¨æˆ·ä¿å­˜çš„æ ç›®å±•å¼€/æ”¶èµ·çŠ¶æ€
- Cookie åç§°æ ¼å¼ï¼š`category_show_status_{ç«™ç‚¹ID}`
- **ç”¨é€”**ï¼šè®°ä½ç”¨æˆ·ä¸Šæ¬¡è®¿é—®æ—¶å“ªäº›æ ç›®æ˜¯æ”¶èµ·çš„

**Cookie æ•°æ®æ ¼å¼**ï¼š
```json
{
  "1": "1",   // æ ç›®IDä¸º1çš„çŠ¶æ€ä¸º1ï¼ˆæ”¶èµ·ï¼‰
  "3": "1",   // æ ç›®IDä¸º3çš„çŠ¶æ€ä¸º1ï¼ˆæ”¶èµ·ï¼‰
  "5": "2"    // æ ç›®IDä¸º5çš„çŠ¶æ€ä¸º2ï¼ˆå±•å¼€ï¼‰
}
```

---

#### **ç¬¬ 23-34 è¡Œï¼šå¤„ç†éœ€è¦éšè—çš„å­æ ç›®**
```php
$tree_toggle = 0;
$childid_hide = '';
if($category_show_status) {
    foreach($category_show_status as $k => $v){
        if($v == '1'){
            $childid_hide .= get_category($k,'arrchildid',true).',';
            $tree_toggle = 1;
        }else{
            $tree_toggle = 0;
        }
    }
}
```

**ä½œç”¨**ï¼š
- éå†å±•å¼€/æ”¶èµ·çŠ¶æ€ï¼Œæ‰¾å‡ºæ‰€æœ‰è¢«æ”¶èµ·çš„æ ç›®
- `$v == '1'` è¡¨ç¤ºè¯¥æ ç›®è¢«æ”¶èµ·
- `get_category($k,'arrchildid',true)`: è·å–è¯¥æ ç›®çš„æ‰€æœ‰å­æ ç›®IDï¼ˆå¦‚ "2,3,4,5"ï¼‰
- `$childid_hide`: ç´¯ç§¯æ‰€æœ‰éœ€è¦éšè—çš„å­æ ç›®IDå­—ç¬¦ä¸²
- `$tree_toggle`: æ ‡è®°æ˜¯å¦æœ‰æ ç›®å¤„äºæ”¶èµ·çŠ¶æ€ï¼ˆç”¨äºå‰ç«¯æ˜¾ç¤ºå±•å¼€/æ”¶èµ·å›¾æ ‡ï¼‰

**ç¤ºä¾‹**ï¼š
```php
// å¦‚æœæ ç›®1è¢«æ”¶èµ·ï¼Œå®ƒçš„å­æ ç›®æ˜¯ 2,3,4
// åˆ™ $childid_hide = "2,3,4,"
```

---

#### **ç¬¬ 35 è¡Œï¼šè½¬æ¢ä¸ºæ•°ç»„**
```php
$arrchildid_arr = explode(',', $childid_hide);
```

**ä½œç”¨**ï¼š
- å°†éœ€è¦éšè—çš„æ ç›®IDå­—ç¬¦ä¸²è½¬æ¢ä¸ºæ•°ç»„
- **ç”¨é€”**ï¼šåé¢åˆ¤æ–­æ¯ä¸ªæ ç›®æ˜¯å¦éœ€è¦éšè—

**ç¤ºä¾‹**ï¼š
```php
// $childid_hide = "2,3,4,"
// $arrchildid_arr = [2, 3, 4, ""]
```

---

#### **ç¬¬ 37-39 è¡Œï¼šåˆå§‹åŒ–æ ‘å½¢ç»“æ„ç±»**
```php
$tree = ryphp::load_sys_class('tree');
$tree->icon = array('&nbsp;&nbsp;&nbsp;â”‚ ','&nbsp;&nbsp;&nbsp;â”œâ”€ ','&nbsp;&nbsp;&nbsp;â””â”€ ');
$tree->nbsp = '&nbsp;&nbsp;&nbsp;';
```

**ä½œç”¨**ï¼š
- åŠ è½½ç³»ç»Ÿæä¾›çš„ `tree` ç±»ï¼ˆä¸“é—¨ç”¨äºç”Ÿæˆæ ‘å½¢ç»“æ„ï¼‰
- è®¾ç½®æ ‘å½¢ç»“æ„çš„æ˜¾ç¤ºç¬¦å·ï¼š
  - `â”‚` : å‚ç›´çº¿ï¼ˆä¸­é—´èŠ‚ç‚¹ï¼‰
  - `â”œâ”€`: Tå½¢è¿æ¥çº¿ï¼ˆæœ‰åç»­å…„å¼ŸèŠ‚ç‚¹ï¼‰
  - `â””â”€`: Lå½¢è¿æ¥çº¿ï¼ˆæœ€åä¸€ä¸ªå…„å¼ŸèŠ‚ç‚¹ï¼‰
- è®¾ç½®ç¼©è¿›ç©ºæ ¼

**æ•ˆæœç¤ºä¾‹**ï¼š
```
â”œâ”€ ä¸€çº§æ ç›®1
â”‚  â”œâ”€ äºŒçº§æ ç›®1-1
â”‚  â””â”€ äºŒçº§æ ç›®1-2
â””â”€ ä¸€çº§æ ç›®2
   â””â”€ äºŒçº§æ ç›®2-1
```

---

#### **ç¬¬ 40 è¡Œï¼šä»æ•°æ®åº“è·å–æ ç›®æ•°æ®**
```php
$data = $this->db->field('catid AS id,catname AS name,parentid,cattype,modelid,listorder,member_publish,pclink,domain,display')
    ->where(array('siteid'=>self::$siteid))
    ->order('listorder ASC,catid ASC')
    ->select();
```

**ä½œç”¨**ï¼š
- æŸ¥è¯¢å½“å‰ç«™ç‚¹çš„æ‰€æœ‰æ ç›®æ•°æ®
- å­—æ®µé‡å‘½åï¼š`catid AS id`, `catname AS name`ï¼ˆé€‚é… tree ç±»çš„è¦æ±‚ï¼‰
- æŒ‰æ’åºå­—æ®µå’ŒIDå‡åºæ’åˆ—

**æŸ¥è¯¢ç»“æœç¤ºä¾‹**ï¼š
```php
[
    ['id' => 1, 'name' => 'æ–°é—»ä¸­å¿ƒ', 'parentid' => 0, 'cattype' => 0, ...],
    ['id' => 2, 'name' => 'å…¬å¸æ–°é—»', 'parentid' => 1, 'cattype' => 0, ...],
    ['id' => 3, 'name' => 'è¡Œä¸šåŠ¨æ€', 'parentid' => 1, 'cattype' => 0, ...],
]
```

---

#### **ç¬¬ 41-70 è¡Œï¼šå¤„ç†æ¯ä¸ªæ ç›®çš„æ˜¾ç¤ºæ•°æ®**
```php
$array = array();
foreach($data as $val){
```

å¼€å§‹éå†æ¯ä¸ªæ ç›®ï¼Œä¸ºå…¶æ·»åŠ æ˜¾ç¤ºç›¸å…³çš„å±æ€§ã€‚

---

#### **ç¬¬ 43-51 è¡Œï¼šæ ¹æ®æ ç›®ç±»å‹è®¾ç½®é“¾æ¥**
```php
if($val['cattype'] == "0"){
    $string = 'lry_open_full("æ·»åŠ å†…å®¹", "'.U('content/add', array('modelid'=>$val['modelid'],'catid'=>$val['id'])).'")'; 
    $val['catlink'] = "javascript:;' onclick='".$string;
}elseif($val['cattype'] == "1"){
    $val['catlink'] = U('page_content',array('catid' => $val['id']));
}else{
    $val['catlink'] = $val['pclink']."' target='_blank";
}
```

**ä½œç”¨**ï¼šæ ¹æ®æ ç›®ç±»å‹è®¾ç½®ä¸åŒçš„ç‚¹å‡»é“¾æ¥
- **ç±»å‹ 0ï¼ˆæ™®é€šæ ç›®ï¼‰**ï¼šç‚¹å‡»å¼¹çª—æ·»åŠ å†…å®¹
- **ç±»å‹ 1ï¼ˆå•é¡µé¢ï¼‰**ï¼šé“¾æ¥åˆ°å•é¡µç¼–è¾‘é¡µ
- **ç±»å‹ 2ï¼ˆå¤–éƒ¨é“¾æ¥ï¼‰**ï¼šåœ¨æ–°çª—å£æ‰“å¼€å¤–éƒ¨é“¾æ¥

---

#### **ç¬¬ 52-57 è¡Œï¼šè®¾ç½®å±•å¼€/æ”¶èµ·å›¾æ ‡**
```php
$icon = '&#xe653;';  // é»˜è®¤å±•å¼€å›¾æ ‡
$action = '2';
if($category_show_status && isset($category_show_status[$val['id']]) && $category_show_status[$val['id']] == '1'){
    $icon = '&#xe652;';  // æ”¶èµ·å›¾æ ‡
    $action = '1';
}
```

**ä½œç”¨**ï¼š
- æ ¹æ®ä¿å­˜çš„çŠ¶æ€è®¾ç½®å›¾æ ‡
- `&#xe653;` å’Œ `&#xe652;` æ˜¯å­—ä½“å›¾æ ‡çš„ Unicode ç¼–ç 
- `action`: 1=æ”¶èµ·çŠ¶æ€, 2=å±•å¼€çŠ¶æ€

---

#### **ç¬¬ 58-60 è¡Œï¼šè®¾ç½®æ ç›®çš„CSSç±»å’Œå±•å¼€/æ”¶èµ·æŒ‰é’®**
```php
$show_status = in_array($val['id'], $arrchildid_arr) ? ' tr_hide' : '';
$val['class'] = $val['parentid'] ? 'child'.$show_status : 'top';
$val['parentoff'] = $val['parentid'] ? '' : '<i class="lry-iconfont parentid" catid="'.$val['id'].'" action="'.$action.'">'.$icon.'</i> ';
```

**ä½œç”¨**ï¼š
- **ç¬¬ 58 è¡Œ**ï¼šåˆ¤æ–­è¯¥æ ç›®æ˜¯å¦éœ€è¦éšè—ï¼ˆæ·»åŠ  `tr_hide` ç±»ï¼‰
- **ç¬¬ 59 è¡Œ**ï¼šè®¾ç½®è¡Œçš„CSSç±»
  - é¡¶çº§æ ç›®ï¼š`class="top"`
  - å­æ ç›®ï¼š`class="child"` æˆ– `class="child tr_hide"`
- **ç¬¬ 60 è¡Œ**ï¼šåªæœ‰é¡¶çº§æ ç›®æ‰æ˜¾ç¤ºå±•å¼€/æ”¶èµ·å›¾æ ‡æŒ‰é’®

---

#### **ç¬¬ 61-65 è¡Œï¼šæ ¼å¼åŒ–æ˜¾ç¤ºå­—æ®µ**
```php
$val['domain'] = $val['domain'] ? '<div title="ç»‘å®šåŸŸåï¼š'.$val['domain'].'" style="color:#0194ff;font-size:12px" class="lry-iconfont">&#xe64a; åŸŸå</div>' : '';
$val['cattype'] = $val['cattype']=="0" ? 'æ™®é€šæ ç›®' : ($val['cattype']=="1" ? '<span style="color:green">å•é¡µé¢</span>' : '<span style="color:red">å¤–éƒ¨é“¾æ¥</span>');
$val['catmodel'] = $val['modelid']&&isset($modelarr[$val['modelid']]) ? $modelarr[$val['modelid']] : 'æ— ';
$val['display'] = $val['display'] ? '<span class="lry-status-enable" ... >æ˜¯</span>' : '<span class="lry-status-disable" ... >å¦</span>';
$val['member_publish'] = $val['member_publish'] ? '<span ... >æ˜¯</span>' : '<span ... >å¦</span>';
```

**ä½œç”¨**ï¼šå°†æ•°æ®åº“å­—æ®µè½¬æ¢ä¸ºå‰ç«¯æ˜¾ç¤ºçš„HTML
- **åŸŸå**ï¼šå¦‚æœç»‘å®šäº†åŸŸåï¼Œæ˜¾ç¤ºåŸŸåå›¾æ ‡å’Œæç¤º
- **æ ç›®ç±»å‹**ï¼š0=æ™®é€šæ ç›®, 1=å•é¡µé¢ï¼ˆç»¿è‰²ï¼‰, 2=å¤–éƒ¨é“¾æ¥ï¼ˆçº¢è‰²ï¼‰
- **æ‰€å±æ¨¡å‹**ï¼šæ˜¾ç¤ºæ¨¡å‹åç§°ï¼ˆä½¿ç”¨ç¬¬16-20è¡Œå»ºç«‹çš„æ˜ å°„ï¼‰
- **å¯¼èˆªæ˜¾ç¤º**ï¼šå¯ç‚¹å‡»åˆ‡æ¢çš„æ˜¯/å¦æŒ‰é’®
- **å…è®¸æŠ•ç¨¿**ï¼šå¯ç‚¹å‡»åˆ‡æ¢çš„æ˜¯/å¦æŒ‰é’®

---

#### **ç¬¬ 66-68 è¡Œï¼šç”Ÿæˆæ“ä½œæŒ‰é’®**
```php
$val['string'] = '<a title="å¢åŠ å­ç±»" href="javascript:;" onclick="lry_open(...)" class="btn-mini btn-primary ml-5">å¢åŠ å­ç±»</a> 
<a title="ç¼–è¾‘æ ç›®" href="javascript:;" onclick="lry_open(...)" class="btn-mini btn-success ml-5">ç¼–è¾‘</a> 
<a title="åˆ é™¤" href="javascript:;" onclick="lry_confirm(...)" class="btn-mini btn-danger ml-5">åˆ é™¤</a>';
```

**ä½œç”¨**ï¼šç”Ÿæˆæ¯è¡Œçš„æ“ä½œæŒ‰é’®ï¼ˆå¢åŠ å­ç±»ã€ç¼–è¾‘ã€åˆ é™¤ï¼‰

---

#### **ç¬¬ 69 è¡Œï¼šå°†å¤„ç†åçš„æ•°æ®åŠ å…¥æ•°ç»„**
```php
$array[] = $val;
```

**ä½œç”¨**ï¼šå°†å¤„ç†å¥½çš„æ ç›®æ•°æ®æ·»åŠ åˆ°æ•°ç»„ä¸­ï¼Œå‡†å¤‡ä¼ ç»™ tree ç±»

---

#### **ç¬¬ 71-83 è¡Œï¼šå®šä¹‰è¡Œæ¨¡æ¿**
```php
$str = "
    <tr class='text-c \$class'>
        <td><input type='text' class='input-text listorder' name='listorder[]' value='\$listorder'><input type='hidden' name='catid[]' value='\$id'></td>
        <td>\$id</td>
        <td class='text-l'> \$parentoff\$spacer <a href='\$catlink'  class='lry_text_link'> \$name</a></td>
        <td>\$cattype</td>
        <td>\$catmodel</td>
        <td><a href='\$pclink' target='_blank'> <i class='lry-iconfont lry-iconlianjie'></i> è®¿é—®</a> \$domain</td>
        <td>\$display</td>
        <td>\$member_publish</td>
        <td class='td-manage'>\$string</td>                   
    </tr>
";
```

**ä½œç”¨**ï¼š
- å®šä¹‰æ¯è¡Œçš„HTMLæ¨¡æ¿
- `\$class`, `\$id`, `\$name` ç­‰å˜é‡ä¼šè¢« tree ç±»è‡ªåŠ¨æ›¿æ¢
- `\$spacer`: tree ç±»è‡ªåŠ¨ç”Ÿæˆçš„æ ‘å½¢ç¼©è¿›ç¬¦å·ï¼ˆ`â”‚`, `â”œâ”€`, `â””â”€`ï¼‰
- `\$parentoff`: å±•å¼€/æ”¶èµ·æŒ‰é’®

**æœ€ç»ˆç”Ÿæˆçš„HTMLç¤ºä¾‹**ï¼š
```html
<tr class='text-c top'>
    <td><input type='text' value='1'></td>
    <td>1</td>
    <td class='text-l'><i class="lry-iconfont parentid">&#xe653;</i> æ–°é—»ä¸­å¿ƒ</td>
    <td>æ™®é€šæ ç›®</td>
    ...
</tr>
<tr class='text-c child'>
    <td><input type='text' value='2'></td>
    <td>2</td>
    <td class='text-l'>&nbsp;&nbsp;&nbsp;â”œâ”€ å…¬å¸æ–°é—»</td>
    ...
</tr>
```

---

#### **ç¬¬ 84-85 è¡Œï¼šç”Ÿæˆæ ‘å½¢ç»“æ„HTML**
```php
$tree->init($array);
$categorys = $tree->get_tree(0, $str);
```

**ä½œç”¨**ï¼š
- `$tree->init($array)`: å°†æ•°æ®ä¼ ç»™ tree ç±»
- `$tree->get_tree(0, $str)`: ä»é¡¶çº§æ ç›®ï¼ˆparentid=0ï¼‰å¼€å§‹ï¼Œé€’å½’ç”Ÿæˆå®Œæ•´çš„æ ‘å½¢HTML
- **å‚æ•° 0**ï¼šè¡¨ç¤ºä» parentid=0 çš„é¡¶çº§æ ç›®å¼€å§‹
- **å‚æ•° $str**ï¼šä½¿ç”¨ä¸Šé¢å®šä¹‰çš„æ¨¡æ¿

---

#### **ç¬¬ 86 è¡Œï¼šåŠ è½½æ¨¡æ¿æ–‡ä»¶**
```php
include $this->admin_tpl('category_list');
```

**ä½œç”¨**ï¼š
- åŠ è½½è§†å›¾æ¨¡æ¿ `application/lry_admin_center/view/category_list.html`
- æ¨¡æ¿ä¸­å¯ä»¥ä½¿ç”¨ `$categorys` å˜é‡æ˜¾ç¤ºç”Ÿæˆçš„æ ‘å½¢åˆ—è¡¨
- æ¨¡æ¿ä¸­ä½¿ç”¨ `<?php echo $categorys; ?>` è¾“å‡ºç”Ÿæˆçš„HTML

---

### ğŸ”„ **å®Œæ•´æµç¨‹å›¾**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. è·å–ç«™ç‚¹æ¨¡å‹ä¿¡æ¯ (get_site_modelinfo)     â”‚
â”‚    æ„å»º æ¨¡å‹ID => æ¨¡å‹åç§° æ˜ å°„              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 2. è¯»å–Cookieä¸­çš„å±•å¼€/æ”¶èµ·çŠ¶æ€               â”‚
â”‚    æ‰¾å‡ºæ‰€æœ‰éœ€è¦éšè—çš„å­æ ç›®ID               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3. åˆå§‹åŒ–treeç±»ï¼Œè®¾ç½®æ ‘å½¢ç»“æ„å›¾æ ‡            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 4. ä»æ•°æ®åº“æŸ¥è¯¢æ‰€æœ‰æ ç›®æ•°æ®                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 5. éå†æ¯ä¸ªæ ç›®ï¼š                            â”‚
â”‚    - æ ¹æ®ç±»å‹è®¾ç½®é“¾æ¥                        â”‚
â”‚    - è®¾ç½®å±•å¼€/æ”¶èµ·å›¾æ ‡                       â”‚
â”‚    - åˆ¤æ–­æ˜¯å¦éœ€è¦éšè—                        â”‚
â”‚    - æ ¼å¼åŒ–æ˜¾ç¤ºå­—æ®µï¼ˆåŸŸåã€ç±»å‹ã€æ¨¡å‹ç­‰ï¼‰    â”‚
â”‚    - ç”Ÿæˆæ“ä½œæŒ‰é’®                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 6. å®šä¹‰HTMLè¡Œæ¨¡æ¿                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 7. treeç±»é€’å½’ç”Ÿæˆå®Œæ•´çš„æ ‘å½¢HTML             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 8. åŠ è½½æ¨¡æ¿æ–‡ä»¶ï¼Œè¾“å‡ºåˆ°é¡µé¢                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### ğŸ¨ **å‰ç«¯å±•ç¤ºæ•ˆæœ**

æœ€ç»ˆç”Ÿæˆçš„é¡µé¢æ•ˆæœï¼š

```
æ ç›®ç®¡ç†
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [æ·»åŠ æ ç›®] [æ·»åŠ å•é¡µ] [æ·»åŠ å¤–éƒ¨é“¾æ¥] [æ‰¹é‡æ·»åŠ ]            â”‚
â”œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚æ’åºâ”‚ID   â”‚ â–¼ æ ç›®åç§°          â”‚ç±»å‹    â”‚æ¨¡å‹  â”‚æ“ä½œ      â”‚
â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1  â”‚  1  â”‚ â–¼ æ–°é—»ä¸­å¿ƒ          â”‚æ™®é€šæ ç›®â”‚æ–‡ç«   â”‚å¢ ç¼– åˆ   â”‚
â”‚ 2  â”‚  2  â”‚   â”œâ”€ å…¬å¸æ–°é—»       â”‚æ™®é€šæ ç›®â”‚æ–‡ç«   â”‚å¢ ç¼– åˆ   â”‚
â”‚ 3  â”‚  3  â”‚   â””â”€ è¡Œä¸šåŠ¨æ€       â”‚æ™®é€šæ ç›®â”‚æ–‡ç«   â”‚å¢ ç¼– åˆ   â”‚
â”‚ 4  â”‚  4  â”‚ â–¼ äº§å“ä¸­å¿ƒ          â”‚æ™®é€šæ ç›®â”‚äº§å“  â”‚å¢ ç¼– åˆ   â”‚
â”‚ 5  â”‚  5  â”‚ â–º å…³äºæˆ‘ä»¬ (æ”¶èµ·)   â”‚å•é¡µé¢  â”‚æ—     â”‚å¢ ç¼– åˆ   â”‚
â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### ğŸ’¡ **æ ¸å¿ƒæŠ€æœ¯ç‚¹**

1. **CookieçŠ¶æ€ä¿æŒ**ï¼šç”¨æˆ·çš„å±•å¼€/æ”¶èµ·æ“ä½œé€šè¿‡Cookieä¿å­˜ï¼Œåˆ·æ–°é¡µé¢åä»ä¿æŒ
2. **æ ‘å½¢ç»“æ„ç”Ÿæˆ**ï¼šä½¿ç”¨ä¸“é—¨çš„ tree ç±»é€’å½’ç”Ÿæˆçˆ¶å­å…³ç³»çš„æ ‘å½¢HTML
3. **åŠ¨æ€æ¨¡æ¿**ï¼šä½¿ç”¨å˜é‡å ä½ç¬¦ï¼ˆ`\$id`, `\$name`ï¼‰ç”±treeç±»è‡ªåŠ¨æ›¿æ¢
4. **MVCåˆ†ç¦»**ï¼šæ§åˆ¶å™¨å¤„ç†æ•°æ®ï¼Œè§†å›¾è´Ÿè´£æ˜¾ç¤º
5. **æ•°æ®ç¼“å­˜**ï¼š`get_site_modelinfo()` å’Œ `get_category()` éƒ½ä½¿ç”¨äº†ç¼“å­˜æœºåˆ¶

---

### ğŸ”‘ **å…³é”®å‡½æ•°è¯´æ˜**

| å‡½æ•°                                       | ä½œç”¨                                 |
| ------------------------------------------ | ------------------------------------ |
| `get_site_modelinfo()`                     | è·å–å½“å‰ç«™ç‚¹çš„æ‰€æœ‰å†…å®¹æ¨¡å‹ï¼ˆæœ‰ç¼“å­˜ï¼‰ |
| `get_category($catid, 'arrchildid', true)` | è·å–æŒ‡å®šæ ç›®çš„æ‰€æœ‰å­æ ç›®IDå­—ç¬¦ä¸²     |
| `U('module/controller/action', $params)`   | ç”ŸæˆURLé“¾æ¥                          |
| `tree->init($array)`                       | åˆå§‹åŒ–æ ‘å½¢æ•°æ®                       |
| `tree->get_tree(0, $template)`             | ä»é¡¶çº§å¼€å§‹é€’å½’ç”Ÿæˆæ ‘å½¢HTML           |

---

å¸Œæœ›è¿™ä¸ªè¯¦ç»†çš„åˆ†æèƒ½å¸®åŠ©ä½ ç†è§£è¿™ä¸ªæ–¹æ³•çš„å®ç°é€»è¾‘ï¼å¦‚æœæœ‰ä»»ä½•ç–‘é—®ï¼Œæ¬¢è¿ç»§ç»­æé—®ã€‚