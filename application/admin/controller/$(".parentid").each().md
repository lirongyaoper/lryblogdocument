## ğŸ“˜ `$(".parentid").each()` è¯¦è§£

### ğŸ¯ **åŸºæœ¬è¯­æ³•**

```javascript
$(".parentid").each(function () {
    // éå†é€»è¾‘
})
```

---

### ğŸ” **åˆ†æ­¥è§£æ**

#### **1. `$(".parentid")` - jQuery é€‰æ‹©å™¨**

**ä½œç”¨ï¼š** é€‰å–é¡µé¢ä¸­æ‰€æœ‰å¸¦æœ‰ `parentid` ç±»çš„å…ƒç´ 

**å¯¹åº” HTMLï¼š** åœ¨ [category.class.php#L107](file:///home/lirongyaoper/Projects/lryblog.com/application/lry_admin_center/controller/category.class.php#L107) ç”Ÿæˆ
```html
<i class="lry-iconfont parentid" catid="3" action="2">&#xe653;</i>
<i class="lry-iconfont parentid" catid="5" action="1">&#xe652;</i>
<i class="lry-iconfont parentid" catid="8" action="2">&#xe653;</i>
```

**è¿”å›å€¼ï¼š** jQuery å¯¹è±¡ï¼ˆç±»æ•°ç»„ï¼‰ï¼ŒåŒ…å«æ‰€æœ‰åŒ¹é…çš„ DOM å…ƒç´ 

```javascript
// ä¾‹å¦‚åŒ…å« 3 ä¸ªå…ƒç´ 
[
    <i class="lry-iconfont parentid" catid="3" action="2">...</i>,
    <i class="lry-iconfont parentid" catid="5" action="1">...</i>,
    <i class="lry-iconfont parentid" catid="8" action="2">...</i>
]
```

---

#### **2. `.each()` - jQuery éå†æ–¹æ³•**

**ä½œç”¨ï¼š** éå† jQuery å¯¹è±¡ä¸­çš„æ¯ä¸ªå…ƒç´ ï¼Œå¯¹æ¯ä¸ªå…ƒç´ æ‰§è¡Œå›è°ƒå‡½æ•°

**è¯­æ³•ï¼š**
```javascript
$(selector).each(function(index, element) {
    // index: å½“å‰å…ƒç´ çš„ç´¢å¼•ï¼ˆä» 0 å¼€å§‹ï¼‰
    // element: å½“å‰çš„ DOM å…ƒç´ 
    // this: æŒ‡å‘å½“å‰ DOM å…ƒç´ 
})
```

---

### ğŸ’¡ **åœ¨ä»£ç ä¸­çš„åº”ç”¨**

```javascript
$(".parentid").each(function () {
    category_show_status[$(this).attr("catid")] = $(this).attr("action");
})
```

**è¯¦ç»†è§£é‡Šï¼š**

| éƒ¨åˆ† | è¯´æ˜ |
|------|------|
| `function ()` | åŒ¿åå›è°ƒå‡½æ•° |
| `this` | æŒ‡å‘å½“å‰éå†åˆ°çš„ DOM å…ƒç´  |
| `$(this)` | å°† DOM å…ƒç´ åŒ…è£…æˆ jQuery å¯¹è±¡ |
| `$(this).attr("catid")` | è·å–å½“å‰å…ƒç´ çš„ `catid` å±æ€§å€¼ |
| `$(this).attr("action")` | è·å–å½“å‰å…ƒç´ çš„ `action` å±æ€§å€¼ |

---

### ğŸ”„ **æ‰§è¡Œæµç¨‹ç¤ºä¾‹**

å‡è®¾é¡µé¢æœ‰ä»¥ä¸‹ HTMLï¼š
```html
<i class="lry-iconfont parentid" catid="1" action="2">&#xe653;</i>
<i class="lry-iconfont parentid" catid="3" action="1">&#xe652;</i>
<i class="lry-iconfont parentid" catid="5" action="2">&#xe653;</i>
```

**æ‰§è¡Œè¿‡ç¨‹ï¼š**

```javascript
var category_show_status = {};

// ç¬¬1æ¬¡å¾ªç¯
// this â†’ <i catid="1" action="2">
// $(this).attr("catid") â†’ "1"
// $(this).attr("action") â†’ "2"
category_show_status["1"] = "2";

// ç¬¬2æ¬¡å¾ªç¯
// this â†’ <i catid="3" action="1">
// $(this).attr("catid") â†’ "3"
// $(this).attr("action") â†’ "1"
category_show_status["3"] = "1";

// ç¬¬3æ¬¡å¾ªç¯
// this â†’ <i catid="5" action="2">
// $(this).attr("catid") â†’ "5"
// $(this).attr("action") â†’ "2"
category_show_status["5"] = "2";

// æœ€ç»ˆç»“æœ
console.log(category_show_status);
// { "1": "2", "3": "1", "5": "2" }
```

---

### ğŸ“Š **each() çš„ä¸‰ç§å†™æ³•å¯¹æ¯”**

#### **å†™æ³•1ï¼šåŒ¿åå‡½æ•°ï¼ˆå½“å‰ä½¿ç”¨ï¼‰**
```javascript
$(".parentid").each(function () {
    category_show_status[$(this).attr("catid")] = $(this).attr("action");
})
```

#### **å†™æ³•2ï¼šå¸¦å‚æ•°çš„å®Œæ•´å†™æ³•**
```javascript
$(".parentid").each(function (index, element) {
    // index: ç´¢å¼•å€¼ (0, 1, 2...)
    // element: DOM å…ƒç´ 
    var $el = $(element); // æˆ– $(this)
    category_show_status[$el.attr("catid")] = $el.attr("action");
})
```

#### **å†™æ³•3ï¼šç®­å¤´å‡½æ•°ï¼ˆES6ï¼‰**
```javascript
$(".parentid").each((index, element) => {
    let $el = $(element);
    category_show_status[$el.attr("catid")] = $el.attr("action");
})
```

âš ï¸ **æ³¨æ„ï¼š** ç®­å¤´å‡½æ•°ä¸­ `this` ä¸æŒ‡å‘å½“å‰å…ƒç´ ï¼Œéœ€ä½¿ç”¨ `element` å‚æ•°

---

### ğŸ†š **each() vs åŸç”Ÿ forEach()**

#### **jQuery each()**
```javascript
$(".parentid").each(function () {
    console.log($(this).attr("catid"));
})
```

#### **åŸç”Ÿ forEach()**
```javascript
document.querySelectorAll(".parentid").forEach(function (element) {
    console.log(element.getAttribute("catid"));
})
```

**å¯¹æ¯”ï¼š**

| ç‰¹æ€§ | jQuery each() | åŸç”Ÿ forEach() |
|------|---------------|----------------|
| å…¼å®¹æ€§ | IE æ‰€æœ‰ç‰ˆæœ¬ | IE9+ |
| `this` æŒ‡å‘ | å½“å‰ DOM å…ƒç´  | `undefined`ï¼ˆä¸¥æ ¼æ¨¡å¼ï¼‰ |
| è¿”å›å€¼ | æ”¯æŒé“¾å¼è°ƒç”¨ | è¿”å› `undefined` |
| æå‰é€€å‡º | `return false` | ä¸æ”¯æŒï¼ˆéœ€ç”¨ `for...of`ï¼‰ |

---

### ğŸ¯ **each() çš„é«˜çº§ç”¨æ³•**

#### **1. ä½¿ç”¨ç´¢å¼•**
```javascript
$(".parentid").each(function (index) {
    console.log("ç¬¬" + (index + 1) + "ä¸ªåˆ†ç±»");
    console.log("catid:", $(this).attr("catid"));
})
```

#### **2. æå‰é€€å‡ºå¾ªç¯**
```javascript
$(".parentid").each(function () {
    if ($(this).attr("catid") === "5") {
        return false; // ç›¸å½“äº breakï¼Œåœæ­¢éå†
    }
    // å¤„ç†é€»è¾‘
})
```

#### **3. è·³è¿‡å½“å‰å¾ªç¯**
```javascript
$(".parentid").each(function () {
    if ($(this).attr("action") === "1") {
        return; // ç›¸å½“äº continueï¼Œè·³è¿‡æœ¬æ¬¡å¾ªç¯
    }
    // å¤„ç†é€»è¾‘
})
```

#### **4. æ€§èƒ½ä¼˜åŒ–ï¼ˆç¼“å­˜ jQuery å¯¹è±¡ï¼‰**
```javascript
$(".parentid").each(function () {
    var $this = $(this); // ç¼“å­˜ï¼Œé¿å…é‡å¤åˆ›å»º jQuery å¯¹è±¡
    category_show_status[$this.attr("catid")] = $this.attr("action");
})
```

---

### âš¡ **æ€§èƒ½å¯¹æ¯”**

å‡è®¾æœ‰ 50 ä¸ªåˆ†ç±»ï¼š

#### **å½“å‰å†™æ³•**
```javascript
$(".parentid").each(function () {
    category_show_status[$(this).attr("catid")] = $(this).attr("action");
})
```
- åˆ›å»º jQuery å¯¹è±¡æ¬¡æ•°ï¼š**100 æ¬¡**ï¼ˆæ¯æ¬¡ `$(this)` éƒ½åˆ›å»ºï¼‰

#### **ä¼˜åŒ–å†™æ³•**
```javascript
$(".parentid").each(function () {
    var $this = $(this);
    category_show_status[$this.attr("catid")] = $this.attr("action");
})
```
- åˆ›å»º jQuery å¯¹è±¡æ¬¡æ•°ï¼š**50 æ¬¡**ï¼ˆç¼“å­˜å¤ç”¨ï¼‰
- **æ€§èƒ½æå‡çº¦ 50%**

---

### ğŸ” **ç­‰ä»·çš„åŸç”Ÿ JavaScript å†™æ³•**

```javascript
// æ–¹æ³•1ï¼šquerySelectorAll + forEach
document.querySelectorAll(".parentid").forEach(function (element) {
    category_show_status[element.getAttribute("catid")] = 
                        element.getAttribute("action");
})

// æ–¹æ³•2ï¼šfor...ofï¼ˆæ¨èï¼‰
for (let element of document.querySelectorAll(".parentid")) {
    category_show_status[element.getAttribute("catid")] = 
                        element.getAttribute("action");
}

// æ–¹æ³•3ï¼šä¼ ç»Ÿ for å¾ªç¯ï¼ˆæ€§èƒ½æœ€ä½³ï¼‰
var elements = document.querySelectorAll(".parentid");
for (var i = 0; i < elements.length; i++) {
    var el = elements[i];
    category_show_status[el.getAttribute("catid")] = 
                        el.getAttribute("action");
}
```

---

### ğŸ“ **å®é™…åº”ç”¨åœºæ™¯**

#### **åœºæ™¯1ï¼šæ‰¹é‡ä¿®æ”¹å±æ€§**
```javascript
$(".parentid").each(function () {
    $(this).attr("data-timestamp", Date.now());
})
```

#### **åœºæ™¯2ï¼šæ¡ä»¶ç­›é€‰**
```javascript
var collapsedIds = [];
$(".parentid").each(function () {
    if ($(this).attr("action") === "1") {
        collapsedIds.push($(this).attr("catid"));
    }
})
```

#### **åœºæ™¯3ï¼šç»Ÿè®¡è®¡æ•°**
```javascript
var expandedCount = 0;
$(".parentid").each(function () {
    if ($(this).attr("action") === "2") {
        expandedCount++;
    }
})
console.log("å±•å¼€çš„åˆ†ç±»æ•°é‡:", expandedCount);
```

---

### âš ï¸ **å¸¸è§é™·é˜±**

#### **é™·é˜±1ï¼šå¿˜è®° `$()` åŒ…è£…**
```javascript
// âŒ é”™è¯¯ï¼šthis æ˜¯ DOM å…ƒç´ ï¼Œæ²¡æœ‰ attr() æ–¹æ³•
$(".parentid").each(function () {
    this.attr("catid"); // TypeError
})

// âœ… æ­£ç¡®ï¼šç”¨ $(this) åŒ…è£…
$(".parentid").each(function () {
    $(this).attr("catid");
})

// âœ… æˆ–ä½¿ç”¨åŸç”Ÿæ–¹æ³•
$(".parentid").each(function () {
    this.getAttribute("catid");
})
```

#### **é™·é˜±2ï¼šç®­å¤´å‡½æ•°ä¸­çš„ this**
```javascript
// âŒ é”™è¯¯ï¼šç®­å¤´å‡½æ•°ä¸­ this ä¸æŒ‡å‘å½“å‰å…ƒç´ 
$(".parentid").each(() => {
    console.log($(this)); // this æŒ‡å‘å¤–å±‚ä½œç”¨åŸŸ
})

// âœ… æ­£ç¡®ï¼šä½¿ç”¨å‚æ•°
$(".parentid").each((index, element) => {
    console.log($(element));
})
```

#### **é™·é˜±3ï¼šåœ¨å¾ªç¯ä¸­ä¿®æ”¹ DOM ç»“æ„**
```javascript
// âš ï¸ å±é™©ï¼šå¯èƒ½å¯¼è‡´æ„å¤–çš„è¡Œä¸º
$(".parentid").each(function () {
    $(this).remove(); // è¾¹éå†è¾¹åˆ é™¤
})

// âœ… æ¨èï¼šå…ˆæ”¶é›†å†æ“ä½œ
var toRemove = [];
$(".parentid").each(function () {
    toRemove.push(this);
})
$(toRemove).remove();
```

---

### ğŸ¯ **æ€»ç»“**

| ç‰¹æ€§ | è¯´æ˜ |
|------|------|
| **æ ¸å¿ƒä½œç”¨** | éå† jQuery å¯¹è±¡ä¸­çš„æ¯ä¸ªå…ƒç´  |
| **this æŒ‡å‘** | å½“å‰éå†åˆ°çš„ DOM å…ƒç´ ï¼ˆéç®­å¤´å‡½æ•°ï¼‰ |
| **å¸¸ç”¨åœºæ™¯** | æ‰¹é‡æ“ä½œã€æ•°æ®é‡‡é›†ã€æ¡ä»¶ç­›é€‰ |
| **æ€§èƒ½å»ºè®®** | ç¼“å­˜ `$(this)`ï¼Œé¿å…é‡å¤åˆ›å»º jQuery å¯¹è±¡ |
| **é€€å‡ºå¾ªç¯** | `return false` æå‰é€€å‡ºï¼Œ`return` è·³è¿‡å½“å‰ |

åœ¨æœ¬é¡¹ç›®ä¸­ï¼Œ`$(".parentid").each()` ç”¨äº**é‡‡é›†æ‰€æœ‰é¡¶çº§åˆ†ç±»çš„å±•å¼€/æ”¶èµ·çŠ¶æ€**ï¼Œæ˜¯å®ç°çŠ¶æ€æŒä¹…åŒ–çš„å…³é”®æ­¥éª¤ã€‚